<Project Sdk="Microsoft.NET.Sdk" ToolsVersion="current">

    <Import Project="Snap.Deps.targets" />

    <PropertyGroup>
        <RootNamespace>Snap</RootNamespace>
        <AssemblyName>Snap</AssemblyName>
        <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
        <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
        <IAmSnapCore>true</IAmSnapCore>
        <DefineConstants>$(DefineConstants);</DefineConstants>
        <IsPackable Condition="$(SnapNupkg)">true</IsPackable>
        <IsTestProject>false</IsTestProject>
        <TargetFrameworks Condition="$(TargetFrameworks) == '' AND $(OsPlatform) == 'Windows'">netcoreapp3.1;net472</TargetFrameworks>
        <TargetFrameworks Condition="$(TargetFrameworks) == '' AND $(OsPlatform) != 'Windows'">netcoreapp3.1</TargetFrameworks>
    </PropertyGroup>

    <PropertyGroup>
        <PackageId>Snapx.Core</PackageId>
        <Description>Core package for the Snapx project.</Description>
    </PropertyGroup>

    <ItemGroup>
        <PackageReference Include="LibLog" Version="5.0.8">
            <PrivateAssets>all</PrivateAssets>
            <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
        </PackageReference>
    </ItemGroup>

    <ItemGroup Condition="!$(IsNetFullFramework)">
        <PackageReference Include="Mono.Posix.NETStandard" Version="1.0.0" />
    </ItemGroup>

    <ItemGroup Condition="$(OsPlatform) == 'Windows'">
        <EmbeddedResource Include="../../build/native/Windows/win-msvs-$(SnapMsvsToolsetVersion)-x64/$(SnapNativeConfiguration)/Snap.CoreRun/$(SnapNativeConfiguration)/corerun.exe" Link="Resources/corerun/corerun.exe" />
        <EmbeddedResource Include="../../build/native/Windows/win-msvs-$(SnapMsvsToolsetVersion)-x64/$(SnapNativeConfiguration)/Snap.CoreRun.Pal/$(SnapNativeConfiguration)/pal.dll" Link="Resources/corerun/libcorerun.dll" />
        <EmbeddedResource Include="../../build/native/Unix/x86_64-linux-gcc/$(SnapNativeConfiguration)/Snap.CoreRun/corerun" Link="Resources/corerun/corerun" />
        <EmbeddedResource Include="../../build/native/Unix/x86_64-linux-gcc/$(SnapNativeConfiguration)/Snap.CoreRun.Pal/libpal.so" Link="Resources/corerun/libcorerun.so" />
    </ItemGroup>

    <ItemGroup Condition="$(OsPlatform) == 'Unix'">
        <EmbeddedResource Include="../../build/native/Unix/x86_64-w64-mingw32-gcc/$(SnapNativeConfiguration)/Snap.CoreRun/corerun.exe" Link="Resources/corerun/corerun.exe" />
        <EmbeddedResource Include="../../build/native/Unix/x86_64-w64-mingw32-gcc/$(SnapNativeConfiguration)/Snap.CoreRun.Pal/libpal.dll" Link="Resources/corerun/libcorerun.dll" />
        <EmbeddedResource Include="../../build/native/Unix/x86_64-linux-gcc/$(SnapNativeConfiguration)/Snap.CoreRun/corerun" Link="Resources/corerun/corerun" />
        <EmbeddedResource Include="../../build/native/Unix/x86_64-linux-gcc/$(SnapNativeConfiguration)/Snap.CoreRun.Pal/libpal.so" Link="Resources/corerun/libcorerun.so" />
    </ItemGroup>

</Project>
